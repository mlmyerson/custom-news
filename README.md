# Custom News

React + TypeScript static site scaffolded with [Vite](https://vitejs.dev/). The `dist/` folder generated by the build step can be deployed to any static host (Netlify, GitHub Pages, Cloudflare Pages, S3, etc.).

## Prerequisites

- Node.js 18+ and npm (or a compatible package manager).

## Setup

```bash
npm install
```

## Development

```bash
npm run dev    # start Vite dev server with hot reloading
```

## Production build

```bash
npm run build  # output static assets to dist/
```

Preview the production build locally:

```bash
npm run preview
```

Deploy the contents of `dist/` to your preferred static hosting platform.

## News API configuration

The headline service (`src/services/fetchHeadlines.ts`) aggregates four public sources. Two of them require API keys that
must be provided through Vite environment variables:

| Source | Endpoint | Environment variable |
| --- | --- | --- |
| The Guardian Open Platform | `https://content.guardianapis.com/search` | `VITE_GUARDIAN_API_KEY` |
| The New York Times Top Stories API | `https://api.nytimes.com/svc/topstories/v2/home.json` | `VITE_NYT_API_KEY` |
| NPR World News RSS | `https://feeds.npr.org/1001/rss.xml` | _none_ |
| Reuters business desk RSS | `https://www.reutersagency.com/feed/?best-topics=business-and-finance` | _none_ |

Create a `.env.local` file in the project root and populate the required keys before running `npm run dev`:

```
VITE_GUARDIAN_API_KEY=<your key>
VITE_NYT_API_KEY=<your key>
```

When one or more keys are missing, the app logs a warning per source, gracefully falls back to mock headlines for the
current session, and caches the result in `localStorage` by date so the UI can continue to function offline.

## Testing

This project uses [Vitest](https://vitest.dev/) and React Testing Library for unit and UI coverage.

| Command | Purpose |
| --- | --- |
| `npm run test` | Run the full Vitest suite once (unit + UI). |
| `npm run test:unit` | Execute only the logic-focused `*.unit.test.ts(x)` files. |
| `npm run test:ui` | Execute the UI-focused `*.ui.test.tsx` files. |
| `npm run test:watch` | Start Vitest in watch mode for local development. |
| `npm run typecheck` | Run TypeScript in `--noEmit` mode to catch type regressions. |

The CI workflow (`.github/workflows/ci.yml`) runs `test:unit`, `test:ui`, `typecheck`, and `build` in parallel on every push/pull
request so regressions are caught before deployment.

## GitHub Pages deployment

This repo ships with two deployment workflows:

### Production deployment (`main` branch)

The workflow `.github/workflows/deploy.yml` builds the site with Node 20 and publishes the `dist/` folder to GitHub Pages. 
Once the workflow is enabled in the repository settings (`Settings → Pages → Build and deployment → GitHub Actions`), 
every push to `main` will:

1. Install dependencies with `npm ci`.
2. Run `npm run build`.
3. Upload the `dist/` artifact and deploy it via `actions/deploy-pages`.

### Development deployment (`development` branch)

The workflow `.github/workflows/deploy-dev.yml` provides automated deployment for the `development` branch. Every push to 
`development` will trigger a deployment to the `development` environment, which can be tracked separately in the 
repository's environments page.

**Note:** Both workflows deploy to the same GitHub Pages URL (`https://<username>.github.io/custom-news/`). The most 
recent deployment (from either `main` or `development`) will be visible at that URL. Use GitHub Environments to track 
which branch is currently deployed and manage deployment history.

Because the project lives at `https://<username>.github.io/custom-news/`, the Vite config sets `base: '/custom-news/'`
so the generated asset paths resolve correctly in production. Update that base path if you fork the repo under a
different name.
